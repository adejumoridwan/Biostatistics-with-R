Case Study: Analyzing Car Performance Metrics

You are a data analyst working for an automotive magazine. Using the "mtcars" dataset, you need to create various visualizations to help readers understand different aspects of car performance. Create the following plots using ggplot2 and provide insights for each:

1. Histogram: Create a histogram of car weights (wt).
2. Bar Chart: Show the average horsepower (hp) for each number of cylinders (cyl).
3. Box Plot: Compare the distribution of miles per gallon (mpg) across different numbers of cylinders (cyl).
4. Pie Chart: Display the proportion of cars with different numbers of gears (gear).
5. Scatter Plot: Plot the relationship between horsepower (hp) and miles per gallon (mpg).
6. Line Graph: Show the trend of average miles per gallon (mpg) as weight (wt) increases.
7. Frequency Polygon: Create a frequency polygon of miles per gallon (mpg).

Here are the solutions with R code and explanations:

```R
# Load required libraries
library(ggplot2)
library(dplyr)

# Load the dataset
data(mtcars)

# 1. Histogram of car weights
ggplot(mtcars, aes(x = wt)) +
  geom_histogram(binwidth = 0.5, fill = "skyblue", color = "black") +
  labs(title = "Distribution of Car Weights",
       x = "Weight (1000 lbs)",
       y = "Frequency")

# 2. Bar Chart of average horsepower by number of cylinders
mtcars %>%
  group_by(cyl) %>%
  summarize(avg_hp = mean(hp)) %>%
  ggplot(aes(x = factor(cyl), y = avg_hp)) +
  geom_bar(stat = "identity", fill = "coral") +
  labs(title = "Average Horsepower by Number of Cylinders",
       x = "Number of Cylinders",
       y = "Average Horsepower")

# 3. Box Plot of mpg across different numbers of cylinders
ggplot(mtcars, aes(x = factor(cyl), y = mpg)) +
  geom_boxplot(fill = "lightgreen") +
  labs(title = "Distribution of MPG by Number of Cylinders",
       x = "Number of Cylinders",
       y = "Miles per Gallon")

# 4. Pie Chart of car gears
mtcars %>%
  count(gear) %>%
  ggplot(aes(x = "", y = n, fill = factor(gear))) +
  geom_bar(stat = "identity", width = 1) +
  coord_polar("y", start = 0) +
  labs(title = "Proportion of Cars by Number of Gears",
       fill = "Number of Gears") +
  theme_void()

# 5. Scatter Plot of horsepower vs mpg
ggplot(mtcars, aes(x = hp, y = mpg)) +
  geom_point(color = "purple") +
  labs(title = "Relationship between Horsepower and Miles per Gallon",
       x = "Horsepower",
       y = "Miles per Gallon")

# 6. Line Graph of average mpg as weight increases
mtcars %>%
  arrange(wt) %>%
  mutate(avg_mpg = cummean(mpg)) %>%
  ggplot(aes(x = wt, y = avg_mpg)) +
  geom_line(color = "red") +
  labs(title = "Trend of Average MPG as Weight Increases",
       x = "Weight (1000 lbs)",
       y = "Average Miles per Gallon")

# 7. Frequency Polygon of mpg
ggplot(mtcars, aes(x = mpg)) +
  geom_freqpoly(binwidth = 2, color = "blue") +
  labs(title = "Frequency Polygon of Miles per Gallon",
       x = "Miles per Gallon",
       y = "Frequency")
```

Explanations for each plot:

1. Histogram: This shows the distribution of car weights. We can see that most cars in the dataset weigh between 2.5 and 3.5 thousand pounds.

2. Bar Chart: This displays the average horsepower for each number of cylinders. As expected, cars with more cylinders tend to have higher average horsepower.

3. Box Plot: This compares the distribution of miles per gallon across different numbers of cylinders. We can observe that cars with fewer cylinders generally have better fuel efficiency (higher mpg).

4. Pie Chart: This shows the proportion of cars with different numbers of gears. We can see the relative frequency of 3-speed, 4-speed, and 5-speed transmissions in the dataset.

5. Scatter Plot: This plot reveals the relationship between horsepower and miles per gallon. There's a clear negative correlation: as horsepower increases, fuel efficiency tends to decrease.

6. Line Graph: This graph shows how the average miles per gallon changes as car weight increases. We can see a downward trend, indicating that heavier cars generally have lower fuel efficiency.

7. Frequency Polygon: This is an alternative to the histogram, showing the distribution of miles per gallon. It allows us to see the shape of the distribution and identify any peaks or patterns in fuel efficiency across the dataset.

These visualizations provide a comprehensive overview of various aspects of car performance in the mtcars dataset. Each plot type serves a different purpose in data visualization, allowing readers to understand different relationships and distributions within the data.

Would you like me to explain or break down any part of the code or analysis further?
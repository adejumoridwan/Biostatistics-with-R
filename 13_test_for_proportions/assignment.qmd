Here’s a case study assignment based on the **test of proportion** and **test of association** topics. This example uses the `heart` dataset from the `datasets` package in R, which contains information on patients’ heart disease diagnosis and associated health attributes. 

The assignment focuses on analyzing the proportion of patients with high cholesterol and examining associations between smoking status and heart disease diagnosis.

---

### Case Study Assignment: Test of Proportion and Association

**Title**: Analysis of Heart Disease Risk Factors Using Proportion Tests and Association Tests

**Dataset**: Use the `heart` dataset in R (from the `datasets` or `MLDataR` package, if available). This dataset includes records of patients with attributes related to heart health, such as cholesterol levels, smoking habits, and heart disease diagnosis.

---

#### Assignment Objectives:

1. **Test of Proportion**:
   - Perform a one-sample Z-test for proportions to determine the proportion of patients with high cholesterol.
   - Conduct a two-sample Z-test for proportions to compare the proportion of high cholesterol cases between male and female patients.

2. **Test of Association**:
   - Use a Chi-square test of independence to evaluate the association between smoking status and heart disease diagnosis.
   - If assumptions for the Chi-square test are not met, conduct Fisher’s Exact Test.

#### Detailed Instructions:

**Step 1**: Load and Prepare Data

1. Load the dataset and inspect its structure to understand the variables. You may need to install additional packages or load from an external source if the dataset isn’t available in your R environment.
2. Clean the data by removing rows with missing values in relevant columns (e.g., cholesterol, gender, smoking status, heart disease diagnosis).

**Step 2**: One-Sample Z-Test for Proportion

1. Define high cholesterol as cholesterol levels above 240 mg/dL.
2. Calculate the proportion of all patients with high cholesterol.
3. Test the hypothesis that at least 50% of patients have high cholesterol using a one-sample Z-test for proportions.
4. Report your findings, including the proportion, Z-statistic, and p-value, and interpret whether there’s statistical evidence that the true proportion of high cholesterol cases is different from 50%.

**Step 3**: Two-Sample Z-Test for Proportion

1. Separate the dataset by gender.
2. Calculate the proportion of high cholesterol cases in males and females.
3. Conduct a two-sample Z-test to test if there is a significant difference between these two proportions.
4. Report the test statistic, p-value, and your conclusion regarding whether the difference in proportions is statistically significant.

**Step 4**: Test of Association Between Smoking and Heart Disease

1. Create a contingency table that shows the frequency of heart disease diagnosis among smokers and non-smokers.
2. Conduct a Chi-square test of independence to evaluate if there is an association between smoking status and heart disease diagnosis.
   - Check the assumptions for the Chi-square test:
     - Independence of observations.
     - Each cell should have an expected frequency of at least 5 for the test to be valid.
3. If Chi-square test assumptions are not met, conduct Fisher’s Exact Test instead.
4. Report the test statistic, p-value, and interpret the results. Describe whether smoking is significantly associated with heart disease in this sample.

**Step 5**: Summary and Interpretation

Summarize your findings in a concise paragraph, addressing:
   - The results of each test (proportion tests and association test).
   - Any observed relationships between cholesterol levels, gender, smoking, and heart disease diagnosis.
   - Possible limitations of the data or analysis, such as sample size or missing values, and suggestions for future studies.

#### Example R Code for Guidance

Here’s a basic structure to help you get started with each test. Customize it based on your dataset and analysis needs.

```r
# Load necessary packages and dataset
if(!require(MASS)) install.packages("MASS")
library(MASS)
data(heart)  # Load dataset (use `MLDataR` if `heart` is not in base R)

# Prepare data: Create a binary variable for high cholesterol
heart$HighChol <- ifelse(heart$chol > 240, "Yes", "No")

# Step 2: One-Sample Z-Test for Proportion
n_total <- nrow(heart)
n_high_chol <- sum(heart$HighChol == "Yes")
p_hat <- n_high_chol / n_total
prop.test(x = n_high_chol, n = n_total, p = 0.5, correct = FALSE)

# Step 3: Two-Sample Z-Test for Proportion by Gender
male_data <- subset(heart, sex == "male")
female_data <- subset(heart, sex == "female")
prop.test(x = c(sum(male_data$HighChol == "Yes"), sum(female_data$HighChol == "Yes")),
          n = c(nrow(male_data), nrow(female_data)), correct = FALSE)

# Step 4: Chi-Square Test or Fisher's Exact Test for Smoking and Heart Disease
table_smoke_hd <- table(heart$smoke, heart$heart_disease)
chisq.test(table_smoke_hd)  # Run Chi-square test
fisher.test(table_smoke_hd)  # Run Fisher's test if Chi-square assumptions are violated
```

#### Expected Submission

- **A report** summarizing findings and interpreting results from each analysis step.
- **R code** used to conduct the tests, along with comments explaining each step.
- **Conclusions** on the relationships between gender, cholesterol levels, smoking, and heart disease based on your analyses.

---

This assignment will help students understand and apply proportion tests and association tests in medical data contexts, providing real-world relevance to statistical testing in health research.